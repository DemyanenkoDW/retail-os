<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RetailOS Pro | Enterprise</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <link rel="stylesheet" href="/css/style.css">
    <script src="/js/api.js"></script>
    <script src="/js/app.js"></script>
</head>
<body class="bg-slate-100 h-screen flex flex-col lg:flex-row overflow-hidden text-slate-800" x-data="retailApp()">

    <div x-show="!user" class="fixed inset-0 z-[100] bg-slate-900 flex items-center justify-center p-4">
        <div class="bg-white p-8 rounded-3xl shadow-2xl w-full max-w-md">
            <h1 class="text-3xl font-black text-center mb-8">Retail<span class="text-blue-600">OS</span></h1>
            <div class="flex border-b mb-6">
                <button @click="authMode='login'" class="flex-1 pb-3 font-bold" :class="authMode==='login'?'border-b-4 border-blue-600 text-blue-600':'text-slate-400'">–í—Ö—ñ–¥</button>
                <button @click="authMode='register'" class="flex-1 pb-3 font-bold" :class="authMode==='register'?'border-b-4 border-blue-600 text-blue-600':'text-slate-400'">–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</button>
            </div>
            <div class="space-y-4">
                <template x-if="authMode==='register'"><input x-model="authForm.storeName" placeholder="–ù–∞–∑–≤–∞ –º–∞–≥–∞–∑–∏–Ω—É" class="w-full p-4 border rounded-2xl"></template>
                <input x-model="authForm.login" placeholder="–õ–æ–≥—ñ–Ω" class="w-full p-4 border rounded-2xl">
                <input x-model="authForm.password" type="password" placeholder="–ü–∞—Ä–æ–ª—å" class="w-full p-4 border rounded-2xl">
                <button @click="auth()" class="w-full bg-blue-600 text-white py-4 rounded-2xl font-black shadow-lg hover:bg-blue-700 transition">–£–í–Ü–ô–¢–ò</button>
            </div>
        </div>
    </div>

    <div x-show="user" class="flex flex-col lg:flex-row h-full w-full no-print" x-cloak>
        <aside class="w-full lg:w-64 bg-slate-900 text-white flex flex-row lg:flex-col shadow-2xl z-50 order-last lg:order-first">
            <div class="hidden lg:block p-6 border-b border-slate-800 font-black text-xl text-blue-500 truncate" x-text="user?.storeName"></div>
            <nav class="flex-1 flex lg:flex-col items-center lg:items-stretch justify-around lg:justify-start p-2 lg:p-4 gap-1 lg:space-y-3">
                <button @click="currentTab='pos'; fetchData()" :class="currentTab==='pos'?'bg-blue-600 text-white':'text-slate-400'" class="flex-1 lg:flex-none flex flex-col lg:flex-row items-center gap-1 lg:gap-4 p-2 lg:p-4 rounded-xl lg:rounded-2xl transition-all">
                    <i class="fa-solid fa-cash-register text-lg lg:text-base"></i> <span class="text-[10px] lg:text-sm lg:inline font-bold">–ö–∞—Å–∞</span>
                </button>
                <button @click="currentTab='stock'; fetchData()" :class="currentTab==='stock'?'bg-blue-600 text-white':'text-slate-400'" class="flex-1 lg:flex-none flex flex-col lg:flex-row items-center gap-1 lg:gap-4 p-2 lg:p-4 rounded-xl lg:rounded-2xl transition-all">
                    <i class="fa-solid fa-boxes-stacked text-lg lg:text-base"></i> <span class="text-[10px] lg:text-sm lg:inline font-bold">–°–∫–ª–∞–¥</span>
                </button>
                <button @click="currentTab='reports'; fetchData()" :class="currentTab==='reports'?'bg-blue-600 text-white':'text-slate-400'" class="flex-1 lg:flex-none flex flex-col lg:flex-row items-center gap-1 lg:gap-4 p-2 lg:p-4 rounded-xl lg:rounded-2xl transition-all">
                    <i class="fa-solid fa-chart-line text-lg lg:text-base"></i> <span class="text-[10px] lg:text-sm lg:inline font-bold">–ó–≤—ñ—Ç–∏</span>
                </button>
                <button @click="currentTab='admin'; fetchData()" :class="currentTab==='admin'?'bg-blue-600 text-white':'text-slate-400'" class="flex-1 lg:flex-none flex flex-col lg:flex-row items-center gap-1 lg:gap-4 p-2 lg:p-4 rounded-xl lg:rounded-2xl transition-all">
                    <i class="fa-solid fa-users-gear text-lg lg:text-base"></i> <span class="text-[10px] lg:text-sm lg:inline font-bold">–ê–¥–º—ñ–Ω</span>
                </button>
                <button @click="logout()" class="flex-1 lg:flex-none lg:mt-auto p-2 lg:p-4 rounded-xl lg:rounded-2xl bg-slate-800 text-slate-400 hover:text-red-400 transition-all">
                    <i class="fa-solid fa-power-off"></i>
                </button>
            </nav>
        </aside>

        <main class="flex-1 p-3 lg:p-6 overflow-hidden flex flex-col">
            
            <div x-show="currentTab==='pos'" class="h-full flex flex-col lg:flex-row gap-4 lg:gap-6 overflow-hidden">
                <div class="flex-1 flex flex-col gap-4 overflow-hidden">
                    <div class="flex-1 bg-white rounded-2xl lg:rounded-3xl shadow-sm border flex flex-col overflow-hidden">
                        <div class="p-3 border-b bg-slate-50/50 flex items-center justify-between">
                            <input x-model="search" placeholder="üîç –ü–æ—à—É–∫..." class="bg-transparent outline-none font-medium text-sm w-full">
                            <span class="hidden sm:block text-[9px] font-black text-slate-400 uppercase whitespace-nowrap">–°–∫–ª–∞–¥</span>
                        </div>
                        <div class="flex-1 overflow-auto px-2">
                            <table class="w-full text-left">
                                <tbody class="text-xs">
                                    <template x-for="i in filteredInventory" :key="i.id">
                                        <tr @click="i.stock > 0 ? addToCart(i) : alert('–¢–æ–≤–∞—Ä—É –Ω–µ–º–∞—î –≤ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ')" 
                                            :class="i.stock <= 0 ? 'opacity-40 grayscale bg-slate-50' : 'hover:bg-blue-50 cursor-pointer'"
                                            class="border-b transition-colors">
                                            <td class="p-3 font-mono text-slate-400 hidden sm:table-cell" x-text="i.code"></td>
                                            <td class="p-3 font-bold" x-text="i.name"></td>
                                            <td class="p-3 text-right font-black text-blue-600" x-text="Number(i.price_sell).toFixed(2)"></td>
                                            <td class="p-3 text-center">
                                                <span :class="i.stock <= 0 ? 'bg-red-50 text-red-600' : 'bg-blue-50 text-blue-700'" 
                                                      class="px-2 py-0.5 rounded-full font-black text-[10px]" x-text="i.stock"></span>
                                            </td>
                                        </tr>
                                    </template>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="hidden lg:flex flex-1 bg-white rounded-3xl shadow-sm border flex flex-col overflow-hidden">
                        <div class="p-4 border-b bg-slate-50/50 flex items-center justify-between">
                            <div class="flex items-center gap-3">
                                <span class="text-[10px] font-black text-slate-400 uppercase tracking-widest">–Ü—Å—Ç–æ—Ä—ñ—è —á–µ–∫—ñ–≤</span>
                                <input type="date" x-model="selectedDate" @change="fetchData()" class="text-xs font-bold bg-white border rounded-lg px-2 py-1 outline-none">
                            </div>
                            <div class="text-[10px] font-bold text-slate-500" x-text="'–í—Å—å–æ–≥–æ: ' + filteredSales.length"></div>
                        </div>
                        <div class="flex-1 overflow-auto px-2">
                            <table class="w-full text-left">
                                <thead class="bg-white sticky top-0 border-b text-[9px] uppercase text-slate-400 font-bold z-10">
                                    <tr>
                                        <th class="p-3">–ß–µ–∫</th>
                                        <th class="p-3">–ü—Ä–æ–¥–∞–≤–µ—Ü—å</th> <th class="p-3">–ß–∞—Å</th>
                                        <th class="p-3 text-right">–°—É–º–∞</th>
                                        <th class="p-3 text-center">–î—ñ—ó</th>
                                    </tr>
                                </thead>
                                <tbody class="text-[11px]">
                                    <template x-for="sale in filteredSales" :key="sale.receipt_id">
                                        <tr class="border-b hover:bg-slate-50 transition-colors">
                                            <td class="p-3 font-mono text-blue-600 font-bold" x-text="sale.receipt_id.split('-').pop()"></td>
                                            <td class="p-3 font-bold text-slate-600" x-text="sale.seller_name || '-'"></td> <td class="p-3 text-slate-500" x-text="sale.created_at.split(' ')[1]"></td>
                                            <td class="p-3 text-right font-black text-slate-700" x-text="Number(sale.total).toFixed(2)"></td>
                                            <td class="p-3 text-center">
                                                <button @click="viewingReceipt = sale" class="w-8 h-8 rounded-full hover:bg-blue-50 text-blue-600 transition-all">
                                                    <i class="fa-solid fa-eye text-sm"></i>
                                                </button>
                                            </td>
                                        </tr>
                                    </template>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="w-full lg:w-96 bg-white rounded-2xl lg:rounded-3xl shadow-2xl border p-4 lg:p-6 flex flex-col h-[45%] lg:h-full">
                    <h3 class="hidden lg:block font-black text-slate-400 uppercase text-[10px] tracking-widest mb-6">–ö–æ—à–∏–∫</h3>
                    <select x-model="currentSeller" class="w-full p-3 lg:p-4 bg-slate-50 border rounded-xl lg:rounded-2xl font-bold outline-none mb-4 text-sm">
                        <template x-for="e in employees" :key="e.id"><option :value="e.name" x-text="e.name"></option></template>
                    </select>
                    <div class="flex-1 overflow-auto space-y-2">
                        <template x-for="(c, idx) in cart" :key="idx">
                            <div class="p-3 lg:p-4 bg-slate-50 rounded-xl lg:rounded-2xl border flex justify-between items-center">
                                <div class="flex-1">
                                    <div class="font-bold text-xs lg:text-sm" x-text="c.name"></div>
                                    <div class="flex items-center gap-3 mt-2 lg:mt-3">
                                        <button @click="c.qty > 1 ? c.qty-- : cart.splice(idx,1)" class="w-7 h-7 bg-white border rounded-lg shadow-sm">-</button>
                                        <span class="font-black w-6 text-center text-xs" x-text="c.qty"></span>
                                        <button @click="c.qty < c.stock ? c.qty++ : null" class="w-7 h-7 bg-white border rounded-lg shadow-sm">+</button>
                                    </div>
                                </div>
                                <div class="text-right font-black text-blue-600 text-sm" x-text="(c.price_sell * c.qty).toFixed(2)"></div>
                            </div>
                        </template>
                    </div>
                    <div class="pt-4 border-t mt-4">
                        <div class="flex justify-between items-center mb-4">
                            <span class="text-slate-400 font-bold uppercase text-[10px]">–í—Å—å–æ–≥–æ</span>
                            <span class="text-2xl lg:text-4xl font-black text-slate-900" x-text="cartTotal.toFixed(2)"></span>
                        </div>
                        <button @click="checkoutModalOpen=true" :disabled="!cart.length" class="w-full py-4 lg:py-5 bg-blue-600 text-white rounded-xl lg:rounded-2xl font-black shadow-xl">–û–ü–õ–ê–¢–ò–¢–ò</button>
                    </div>
                </div>
            </div>

            <div x-show="currentTab==='stock'" class="h-full flex flex-col" x-cloak>
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6">
                    <h2 class="text-2xl lg:text-3xl font-black">–°–∫–ª–∞–¥</h2>
                    <div class="flex gap-2 w-full sm:w-auto">
                        <button @click="printInventory()" class="flex-1 sm:flex-none bg-slate-800 text-white px-4 py-3 rounded-xl lg:rounded-2xl font-black shadow-lg hover:bg-slate-700 transition flex items-center justify-center gap-2 text-xs">
                            <i class="fa-solid fa-print"></i> –Ü–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü—ñ—è
                        </button>
                        <button @click="openItemModal()" class="flex-1 sm:flex-none bg-blue-600 text-white px-4 py-3 rounded-xl lg:rounded-2xl font-black shadow-lg text-xs">+ –¢–æ–≤–∞—Ä</button>
                    </div>
                </div>
                <div class="bg-white rounded-2xl lg:rounded-3xl border shadow-sm overflow-hidden text-xs lg:text-sm">
                    <div class="overflow-x-auto">
                        <table class="w-full text-left min-w-[600px]">
                            <thead class="bg-slate-50 border-b text-[10px] font-bold text-slate-400 uppercase">
                                <tr><th class="p-5">–ö–æ–¥</th><th class="p-5">–ù–∞–∑–≤–∞</th><th class="p-5">–ó–∞–∫—É–ø–∫–∞</th><th class="p-5">–ü—Ä–æ–¥–∞–∂</th><th class="p-5 text-center">–ó–∞–ª–∏—à–æ–∫</th><th class="p-5">–î—ñ—ó</th></tr>
                            </thead>
                            <tbody>
                                <template x-for="item in inventory.filter(i => i.stock > 0)" :key="item.id">
                                    <tr class="border-b hover:bg-slate-50 transition-colors">
                                        <td class="p-5 font-mono text-slate-400" x-text="item.code"></td>
                                        <td class="p-5 font-bold text-slate-800" x-text="item.name"></td>
                                        <td class="p-5 text-slate-500" x-text="Number(item.price_buy).toFixed(2)"></td>
                                        <td class="p-5 font-black text-blue-600" x-text="Number(item.price_sell).toFixed(2)"></td>
                                        <td class="p-5 text-center">
                                            <span class="bg-green-50 text-green-700 px-3 py-1 rounded-full font-black text-xs" x-text="item.stock"></span>
                                        </td>
                                        <td class="p-5 text-right">
                                            <button @click="openItemModal(item)" class="text-blue-500 hover:text-blue-700 transition">
                                                <i class="fa-solid fa-pen"></i>
                                            </button>
                                        </td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div x-show="currentTab==='reports'" class="p-2 lg:p-6 space-y-6 lg:space-y-8 overflow-auto h-full">
                <div>
                    <h2 class="text-xl font-black text-slate-800 mb-4 flex items-center gap-2">
                        <i class="fa-solid fa-users text-blue-600"></i> –ê–Ω–∞–ª—ñ—Ç–∏–∫–∞
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <template x-for="stat in sellerStats" :key="stat.seller_name">
                            <div class="bg-white p-5 rounded-3xl border shadow-sm hover:shadow-md transition-shadow">
                                <div class="flex justify-between items-start mb-3">
                                    <div class="font-black text-slate-800 text-lg" x-text="stat.seller_name"></div>
                                    <span class="bg-blue-50 text-blue-700 text-[10px] font-black px-2 py-1 rounded-lg uppercase" x-text="stat.count + ' —á–µ–∫—ñ–≤'"></span>
                                </div>
                                <div class="space-y-2">
                                    <div class="flex justify-between text-sm">
                                        <span class="text-slate-500">–í–∏—Ä—É—á–∫–∞:</span>
                                        <span class="font-bold text-slate-800" x-text="Number(stat.revenue).toFixed(2) + ' –≥—Ä–Ω'"></span>
                                    </div>
                                    <div class="flex justify-between text-sm">
                                        <span class="text-slate-500">–ü—Ä–∏–±—É—Ç–æ–∫:</span>
                                        <span class="font-bold text-green-600" x-text="Number(stat.profit).toFixed(2) + ' –≥—Ä–Ω'"></span>
                                    </div>
                                    <div class="w-full bg-slate-100 h-1.5 rounded-full mt-2">
                                        <div class="bg-green-500 h-1.5 rounded-full" :style="'width: ' + (stat.profit/stat.revenue*100) + '%'"></div>
                                    </div>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>

                <div>
                    <h2 class="text-xl font-black text-slate-800 mb-4 flex items-center gap-2">
                        <i class="fa-solid fa-calendar-day text-blue-600"></i> –ü–æ –¥–Ω—è—Ö
                    </h2>
                    <div class="bg-white rounded-3xl border shadow-sm overflow-hidden">
                        <div class="overflow-x-auto">
                            <table class="w-full text-left border-collapse min-w-[500px]">
                                <thead class="bg-slate-50 border-b">
                                    <tr class="text-[11px] uppercase text-slate-400 font-black">
                                        <th class="p-4">–î–∞—Ç–∞</th>
                                        <th class="p-4 text-center">–ß–µ–∫–∏</th>
                                        <th class="p-4 text-right">–í–∏—Ä—É—á–∫–∞</th>
                                        <th class="p-4 text-right">–ü—Ä–∏–±—É—Ç–æ–∫</th>
                                        <th class="p-4 text-right">–ú–∞—Ä–∂–∞ (%)</th>
                                    </tr>
                                </thead>
                                <tbody class="text-sm">
                                    <template x-for="rep in reports" :key="rep.day">
                                        <tr class="border-b last:border-0 hover:bg-slate-50 transition-colors">
                                            <td class="p-4 font-bold text-slate-700" x-text="rep.day"></td>
                                            <td class="p-4 text-center">
                                                <span class="bg-slate-100 text-slate-600 px-2 py-1 rounded-md font-bold text-xs" x-text="rep.count"></span>
                                            </td>
                                            <td class="p-4 text-right font-bold text-slate-800" x-text="Number(rep.revenue).toFixed(2)"></td>
                                            <td class="p-4 text-right font-bold text-green-600" x-text="Number(rep.profit).toFixed(2)"></td>
                                            <td class="p-4 text-right text-slate-400 font-mono text-xs" 
                                                x-text="rep.revenue > 0 ? ((rep.profit / rep.revenue) * 100).toFixed(1) + '%' : '0%'">
                                            </td>
                                        </tr>
                                    </template>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div x-show="currentTab==='admin'" class="h-full flex flex-col" x-cloak>
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl lg:text-3xl font-black">–ü–µ—Ä—Å–æ–Ω–∞–ª</h2>
                    <button @click="openEmpModal()" class="bg-blue-600 text-white px-4 lg:px-8 py-3 rounded-xl lg:rounded-2xl font-black text-xs">–î–æ–¥–∞—Ç–∏</button>
                </div>
                <div class="bg-white rounded-2xl lg:rounded-3xl border shadow-sm overflow-hidden">
                    <div class="overflow-x-auto">
                        <table class="w-full text-left text-sm min-w-[400px]">
                            <thead class="bg-slate-50 border-b text-[10px] font-bold text-slate-400 uppercase">
                                <tr><th class="p-5">–ü–Ü–ë</th><th class="p-5">–ü–æ—Å–∞–¥–∞</th><th class="p-5 text-right">–î—ñ—ó</th></tr>
                            </thead>
                            <tbody>
                                <template x-for="e in employees" :key="e.id">
                                    <tr class="border-b">
                                        <td class="p-5 font-bold" x-text="e.name"></td>
                                        <td class="p-5 text-slate-500" x-text="e.position"></td>
                                        <td class="p-5 text-right">
                                            <button @click="openEmpModal(e)" class="text-blue-500 mr-4"><i class="fa-solid fa-pen"></i></button>
                                        </td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <div x-show="modalOpen" class="fixed inset-0 z-[110] bg-slate-900/80 backdrop-blur-sm flex items-center justify-center p-4" x-cloak>
        <div class="bg-white rounded-[2.5rem] p-8 w-full max-w-sm shadow-2xl overflow-y-auto max-h-[90vh]">
            <h3 class="text-2xl font-black mb-6 text-slate-800" x-text="editId ? '–†–µ–¥–∞–≥—É–≤–∞—Ç–∏' : '–ù–æ–≤–∏–π —Ç–æ–≤–∞—Ä'"></h3>
            <div class="space-y-5">
                <div>
                    <label class="text-[10px] font-bold uppercase text-slate-400 ml-2 mb-1 block tracking-widest">–ö–æ–¥ / –®—Ç—Ä–∏—Ö-–∫–æ–¥</label>
                    <input x-model="newItem.code" :class="isCodeDuplicate ? 'border-red-500 bg-red-50 ring-2 ring-red-100' : 'border-slate-200'" placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: 1001" class="w-full p-4 border rounded-2xl outline-none focus:border-blue-500 transition-all font-mono">
                    <template x-if="isCodeDuplicate"><span class="text-red-500 text-[10px] font-bold mt-1 ml-2 block italic uppercase">–¢–∞–∫–∏–π –∫–æ–¥ –≤–∂–µ —ñ—Å–Ω—É—î</span></template>
                </div>
                <div>
                    <label class="text-[10px] font-bold uppercase text-slate-400 ml-2 mb-1 block tracking-widest">–ù–∞–∑–≤–∞ —Ç–æ–≤–∞—Ä—É</label>
                    <input x-model="newItem.name" placeholder="–ù–∞–∑–≤–∞ —Ç–æ–≤–∞—Ä—É" class="w-full p-4 border border-slate-200 rounded-2xl outline-none focus:border-blue-500 transition-all">
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="text-[10px] font-bold uppercase text-slate-400 ml-2 mb-1 block tracking-widest">–ó–∞–∫—É–ø–∫–∞</label>
                        <input x-model.number="newItem.buy" type="number" step="0.01" class="w-full p-4 border border-slate-200 rounded-2xl outline-none">
                    </div>
                    <div>
                        <label class="text-[10px] font-bold uppercase text-slate-400 ml-2 mb-1 block tracking-widest">–ü—Ä–æ–¥–∞–∂</label>
                        <input x-model.number="newItem.sell" type="number" step="0.01" class="w-full p-4 border border-slate-200 rounded-2xl outline-none font-bold text-blue-600">
                    </div>
                </div>
                <div>
                    <label class="text-[10px] font-bold uppercase text-slate-400 ml-2 mb-1 block tracking-widest">–ö—ñ–ª—å–∫—ñ—Å—Ç—å</label>
                    <input x-model.number="newItem.qty" type="number" class="w-full p-4 border border-slate-200 rounded-2xl outline-none font-black">
                </div>
                <div class="flex gap-4 pt-4">
                    <button @click="modalOpen=false" class="flex-1 py-4 bg-slate-100 text-slate-600 rounded-2xl font-bold">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
                    <button @click="saveItem()" :disabled="isCodeDuplicate" :class="isCodeDuplicate ? 'opacity-50 cursor-not-allowed' : 'hover:bg-blue-700'" class="flex-1 py-4 bg-blue-600 text-white rounded-2xl font-black shadow-lg">–ó–ë–ï–†–ï–ì–¢–ò</button>
                </div>
            </div>
        </div>
    </div>

    <div x-show="checkoutModalOpen" class="fixed inset-0 z-[110] bg-slate-900/80 backdrop-blur-sm flex items-center justify-center p-4" x-cloak>
        <div class="bg-white rounded-[2.5rem] p-8 w-full max-w-sm shadow-2xl">
            <div class="text-center mb-6">
                <span class="text-[10px] font-bold uppercase text-slate-400 tracking-widest block mb-1">–î–æ —Å–ø–ª–∞—Ç–∏</span>
                <div class="text-5xl font-black text-blue-600" x-text="cartTotal.toFixed(2)"></div>
            </div>
            <div class="space-y-4">
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="text-[10px] font-bold uppercase text-slate-400 ml-2 mb-1 block tracking-widest">–ì–æ—Ç—ñ–≤–∫–∞</label>
                        <input x-model.number="payForm.cash" type="number" step="0.01" class="w-full p-4 bg-slate-50 border-2 border-slate-100 rounded-2xl text-xl font-black outline-none focus:border-blue-500">
                    </div>
                    <div>
                        <label class="text-[10px] font-bold uppercase text-slate-400 ml-2 mb-1 block tracking-widest">–ö–∞—Ä—Ç–∫–∞</label>
                        <input x-model.number="payForm.card" type="number" step="0.01" class="w-full p-4 bg-slate-50 border-2 border-slate-100 rounded-2xl text-xl font-black outline-none focus:border-blue-500">
                    </div>
                </div>
                <div class="p-4 bg-slate-100 rounded-2xl flex justify-between items-center border border-slate-200">
                    <span class="text-[10px] font-bold text-slate-500 uppercase tracking-widest">–ó–¥–∞—á–∞:</span>
                    <span class="text-2xl font-black" :class="change < 0 ? 'text-red-500' : 'text-green-600'" x-text="change.toFixed(2)"></span>
                </div>
                <div class="space-y-3 pt-4">
                    <div class="flex gap-3">
                        <button @click="checkoutModalOpen=false" class="px-6 py-4 bg-slate-50 text-slate-400 rounded-2xl font-bold">
                            <i class="fa-solid fa-arrow-left"></i>
                        </button>
                        <button @click="processCheckout(true)" :disabled="change < 0" :class="change < 0 ? 'opacity-50' : 'hover:bg-slate-800'" class="flex-1 py-4 bg-slate-900 text-white rounded-2xl font-black flex items-center justify-center gap-2 transition-all">
                            <i class="fa-solid fa-print"></i> –î–†–£–ö –ß–ï–ö–£
                        </button>
                    </div>
                    <button @click="processCheckout(false)" :disabled="change < 0" :class="change < 0 ? 'opacity-50' : 'hover:bg-green-700 shadow-green-100'" class="w-full py-5 bg-green-600 text-white rounded-2xl font-black text-xl shadow-xl transition-all uppercase tracking-wider">–ü—Ä–æ–≤–µ—Å—Ç–∏</button>
                </div>
            </div>
        </div>
    </div>

    <div id="print-area" class="hidden font-mono text-sm p-4">
        <div class="w-[72mm] mx-auto text-center">
            <div class="font-black text-xl uppercase" x-text="user?.storeName"></div>
            <div class="text-[10px] mb-4" x-text="'–ß–ï–ö #' + lastReceiptId"></div>
            <div class="border-b border-dashed border-black my-2"></div>
            <template x-for="item in cartToPrint">
                <div class="flex justify-between text-left mb-1">
                    <span class="flex-1" x-text="item.name"></span>
                    <span x-text="item.qty + ' x ' + item.price_sell"></span>
                </div>
            </template>
            <div class="border-b border-dashed border-black my-2"></div>
            <div class="flex justify-between font-black text-lg uppercase">
                <span>–†–∞–∑–æ–º:</span>
                <span x-text="cartToPrint.reduce((s,i)=>s+(i.price_sell*i.qty),0).toFixed(2)"></span>
            </div>
            <div class="mt-4 text-[10px]" x-text="new Date().toLocaleString()"></div>
        </div>
    </div>

    <div x-show="empModalOpen" class="fixed inset-0 z-[110] bg-slate-900/80 backdrop-blur-sm flex items-center justify-center p-4" x-cloak>
        <div class="bg-white rounded-[2.5rem] p-8 w-full max-w-sm shadow-2xl">
            <h3 class="text-2xl font-black mb-6 text-slate-800" x-text="editEmpId ? '–†–µ–¥–∞–≥—É–≤–∞—Ç–∏' : '–ù–æ–≤–∏–π –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫'"></h3>
            <div class="space-y-5">
                <div>
                    <label class="text-[10px] font-bold uppercase text-slate-400 ml-2 mb-1 block tracking-widest">–ü–Ü–ë –ü—Ä–∞—Ü—ñ–≤–Ω–∏–∫–∞</label>
                    <input x-model="newEmp.name" class="w-full p-4 border border-slate-200 rounded-2xl outline-none">
                </div>
                <div>
                    <label class="text-[10px] font-bold uppercase text-slate-400 ml-2 mb-1 block tracking-widest">–ü–æ—Å–∞–¥–∞</label>
                    <input x-model="newEmp.position" class="w-full p-4 border border-slate-200 rounded-2xl outline-none">
                </div>
                <div class="flex gap-4 pt-4">
                    <button @click="empModalOpen=false" class="flex-1 py-4 bg-slate-100 text-slate-600 rounded-2xl font-bold">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
                    <button @click="saveEmployee()" class="flex-1 py-4 bg-blue-600 text-white rounded-2xl font-black shadow-lg">–ó–ë–ï–†–ï–ì–¢–ò</button>
                </div>
            </div>
        </div>
    </div>

    <div x-show="viewingReceipt" class="fixed inset-0 z-[120] bg-slate-900/90 backdrop-blur-md flex items-center justify-center p-4" x-cloak>
        <div class="bg-white rounded-[2.5rem] p-8 w-full max-w-lg shadow-2xl">
            <div class="flex justify-between items-start mb-6">
                <div>
                    <h3 class="text-xl font-black text-slate-800" x-text="'–ß–µ–∫ ' + viewingReceipt?.receipt_id"></h3>
                    <p class="text-xs text-slate-400 font-bold uppercase tracking-wider" x-text="viewingReceipt?.created_at"></p>
                </div>
                <button @click="viewingReceipt = null" class="text-slate-300 hover:text-slate-600 transition"><i class="fa-solid fa-circle-xmark text-2xl"></i></button>
            </div>
            <div class="border rounded-2xl overflow-hidden mb-6">
                <table class="w-full text-left text-sm">
                    <thead class="bg-slate-50 text-[10px] font-bold uppercase text-slate-400 border-b">
                        <tr><th class="p-3">–¢–æ–≤–∞—Ä</th><th class="p-3 text-center">–ö-—Å—Ç—å</th><th class="p-3 text-right">–¶—ñ–Ω–∞</th></tr>
                    </thead>
                    <tbody>
                        <template x-for="item in salesDetails.filter(d => d.receipt_id === viewingReceipt?.receipt_id)" :key="item.name + Math.random()">
                            <tr class="border-b last:border-0">
                                <td class="p-3 font-medium text-slate-700" x-text="item.name"></td>
                                <td class="p-3 text-center font-bold text-slate-600" x-text="item.qty"></td>
                                <td class="p-3 text-right font-black text-blue-600" x-text="Number(item.price_sell).toFixed(2)"></td>
                            </tr>
                        </template>
                    </tbody>
                </table>
            </div>
            <div class="flex justify-between items-center p-4 bg-blue-50 rounded-2xl">
                <span class="font-bold text-blue-900 uppercase text-xs">–ó–∞–≥–∞–ª—å–Ω–∞ —Å—É–º–∞:</span>
                <span class="text-2xl font-black text-blue-600" x-text="Number(viewingReceipt?.total).toFixed(2)"></span>
            </div>
            <button @click="viewingReceipt = null" class="w-full mt-6 py-4 bg-slate-900 text-white rounded-2xl font-black uppercase tracking-widest">–ó–∞–∫—Ä–∏—Ç–∏</button>
        </div>
    </div>
</body>
</html>